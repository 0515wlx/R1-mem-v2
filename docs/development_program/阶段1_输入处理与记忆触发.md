### 阶段1：输入处理与记忆触发
[输入文本处理实现](/docs/example/输入文本处理.py) | [记忆检索与触发实现](/docs/example/记忆检索与触发.py) | [记忆检索实现](/docs/example/记忆检索.py)

#### 技术实现（完全采用Titans方案）

1. **输入文本处理**  
   - 使用标准神经网络编码器对输入文本进行处理，提取语义特征。

2. **记忆检索与触发**  
   - 通过惊喜度量（Surprise Metric）决定是否触发记忆检索。惊喜度量定义为模型对输入的梯度，梯度越大表示输入越具“惊喜性”。
   - 更新公式为：
     \[
     M_t = M_{t-1} + S_t
     \]
     \[
     S_t = \eta_t S_{t-1} - \theta_t \nabla \mathcal{L}(M_{t-1}; x_t)
     \]  
     其中，\(\eta_t\) 控制惊喜的衰减，\(\theta_t\) 控制当前惊喜的影响。

3. **记忆检索**  
   - 通过前向传播（不更新权重）从记忆中检索信息：
     \[
     y_t = M^*(q_t)
     \]
     其中，\(q_t = x_t W_q\) 是查询的投影。

#### 关键点

1. **惊喜度量触发**  
   - 通过梯度变化动态决定是否调用记忆，确保在需要时及时引入外部知识。

2. **高效检索机制**  
   - 使用前向传播实现记忆检索，避免额外的计算开销。